# Flask
SECRET_KEY=replace-with-strong-random-value
JWT_SECRET_KEY=replace-with-strong-random-value
FLASK_DEBUG=false
SECURITY_ENFORCE_STRONG_SECRETS=true
MAX_REQUEST_BYTES=1048576
CORS_ALLOWED_ORIGINS=https://app.auraxis.com.br,https://www.auraxis.com.br

# Database (Docker prod plan A: postgres container)
POSTGRES_DB=flaskdb
POSTGRES_USER=flaskuser
POSTGRES_PASSWORD=replace-with-strong-password
DB_HOST=db
DB_PORT=5432
DB_NAME=flaskdb
DB_USER=flaskuser
DB_PASS=replace-with-strong-password

# Optional runtime URL override (plan B: RDS)
# DATABASE_URL=postgresql://user:password@rds-endpoint:5432/flaskdb

# BRAPI
BRAPI_KEY=

# Domain / TLS
DOMAIN=api.auraxis.com.br
CERTBOT_EMAIL=you@example.com

# Startup strategy
# Use migrations when folder exists; otherwise entrypoint falls back to AUTO_CREATE_DB=true.
AUTO_CREATE_DB=false
MIGRATE_ON_START=true
DB_WAIT_TIMEOUT=90

# Gunicorn
GUNICORN_WORKERS=2
GUNICORN_THREADS=2
GUNICORN_TIMEOUT=60

# Rate limiting (S2 baseline)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT_LIMIT=300
RATE_LIMIT_DEFAULT_WINDOW_SECONDS=60
RATE_LIMIT_AUTH_LIMIT=20
RATE_LIMIT_AUTH_WINDOW_SECONDS=60
RATE_LIMIT_GRAPHQL_LIMIT=120
RATE_LIMIT_GRAPHQL_WINDOW_SECONDS=60
RATE_LIMIT_TRANSACTIONS_LIMIT=180
RATE_LIMIT_TRANSACTIONS_WINDOW_SECONDS=60
RATE_LIMIT_WALLET_LIMIT=180
RATE_LIMIT_WALLET_WINDOW_SECONDS=60
RATE_LIMIT_TRUST_PROXY_HEADERS=true
RATE_LIMIT_BACKEND=redis
RATE_LIMIT_FAIL_CLOSED=true
# RATE_LIMIT_REDIS_URL=redis://redis:6379/0

# GraphQL transport hardening (S2 baseline)
GRAPHQL_MAX_QUERY_BYTES=20000
GRAPHQL_MAX_DEPTH=8
GRAPHQL_MAX_COMPLEXITY=300
GRAPHQL_MAX_OPERATIONS=3
GRAPHQL_MAX_LIST_MULTIPLIER=50
GRAPHQL_ALLOW_INTROSPECTION=false
GRAPHQL_PUBLIC_QUERIES=__typename
GRAPHQL_PUBLIC_MUTATIONS=registerUser,login
GRAPHQL_ALLOW_UNNAMED_OPERATIONS=false

# Audit trail
AUDIT_TRAIL_ENABLED=true
AUDIT_PATH_PREFIXES=/auth/,/user/,/transactions/,/wallet,/graphql
AUDIT_PERSISTENCE_ENABLED=true
AUDIT_RETENTION_ENABLED=true
AUDIT_RETENTION_DAYS=90
# Retention purge is external to requests:
# flask audit-events purge-expired --retention-days 90

# Login brute-force guard (S5-06 fase 1)
LOGIN_GUARD_ENABLED=true
LOGIN_GUARD_BACKEND=redis
# LOGIN_GUARD_REDIS_URL=redis://redis:6379/0
LOGIN_GUARD_FAIL_CLOSED=true
LOGIN_GUARD_REDIS_KEY_PREFIX=auraxis:login-guard
LOGIN_GUARD_FAILURE_THRESHOLD=5
LOGIN_GUARD_KNOWN_FAILURE_THRESHOLD=3
LOGIN_GUARD_BASE_COOLDOWN_SECONDS=30
LOGIN_GUARD_MAX_COOLDOWN_SECONDS=900
LOGIN_GUARD_KNOWN_BASE_COOLDOWN_SECONDS=60
LOGIN_GUARD_KNOWN_MAX_COOLDOWN_SECONDS=1800
LOGIN_GUARD_RETENTION_SECONDS=3600
LOGIN_GUARD_MAX_KEYS=20000
LOGIN_GUARD_TRUST_PROXY_HEADERS=true

# Cloud secrets source of truth (S5-05)
# Use script `scripts/sync_cloud_secrets.py` to generate `.env.runtime` in EC2.
AURAXIS_SECRETS_BACKEND=ssm
AWS_REGION=us-east-1
AURAXIS_SSM_PATH=/auraxis/prod
# AURAXIS_SECRETS_MANAGER_ID=auraxis/prod/app
