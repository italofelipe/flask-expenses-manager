# Flask
SECRET_KEY=dev-secret-key-change-me
JWT_SECRET_KEY=dev-jwt-secret-key-change-me
FLASK_DEBUG=true
SECURITY_ENFORCE_STRONG_SECRETS=false
MAX_REQUEST_BYTES=1048576
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Database (Docker dev)
POSTGRES_DB=flaskdb
POSTGRES_USER=flaskuser
POSTGRES_PASSWORD=flaskpass
DB_HOST=db
DB_PORT=5432
DB_NAME=flaskdb
DB_USER=flaskuser
DB_PASS=flaskpass

# Optional external integrations
BRAPI_KEY=

# Optional runtime URL override
# DATABASE_URL=postgresql://flaskuser:flaskpass@db:5432/flaskdb

# Rate limiting (S2 baseline)
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT_LIMIT=300
RATE_LIMIT_DEFAULT_WINDOW_SECONDS=60
RATE_LIMIT_AUTH_LIMIT=20
RATE_LIMIT_AUTH_WINDOW_SECONDS=60
RATE_LIMIT_GRAPHQL_LIMIT=120
RATE_LIMIT_GRAPHQL_WINDOW_SECONDS=60
RATE_LIMIT_TRANSACTIONS_LIMIT=180
RATE_LIMIT_TRANSACTIONS_WINDOW_SECONDS=60
RATE_LIMIT_WALLET_LIMIT=180
RATE_LIMIT_WALLET_WINDOW_SECONDS=60
RATE_LIMIT_TRUST_PROXY_HEADERS=false
RATE_LIMIT_BACKEND=memory
RATE_LIMIT_FAIL_CLOSED=false
RATE_LIMIT_REDIS_URL=redis://redis:6379/0

# GraphQL transport hardening (S2 baseline)
GRAPHQL_MAX_QUERY_BYTES=20000
GRAPHQL_MAX_DEPTH=8
GRAPHQL_MAX_COMPLEXITY=300
GRAPHQL_MAX_OPERATIONS=3
GRAPHQL_MAX_LIST_MULTIPLIER=50
GRAPHQL_ALLOW_INTROSPECTION=true
GRAPHQL_PUBLIC_QUERIES=__typename
GRAPHQL_PUBLIC_MUTATIONS=registerUser,login
GRAPHQL_ALLOW_UNNAMED_OPERATIONS=true

# API documentation exposure
DOCS_EXPOSURE_POLICY=public

# Audit trail
AUDIT_TRAIL_ENABLED=true
AUDIT_PATH_PREFIXES=/auth/,/user/,/transactions/,/wallet,/graphql
AUDIT_PERSISTENCE_ENABLED=false
AUDIT_RETENTION_ENABLED=true
AUDIT_RETENTION_DAYS=90
# Retention purge is external to requests:
# flask audit-events purge-expired --retention-days 90

# Login brute-force guard (S5-06 fase 1)
LOGIN_GUARD_ENABLED=true
LOGIN_GUARD_BACKEND=memory
LOGIN_GUARD_REDIS_URL=redis://redis:6379/0
LOGIN_GUARD_FAIL_CLOSED=false
LOGIN_GUARD_REDIS_KEY_PREFIX=auraxis:login-guard
LOGIN_GUARD_FAILURE_THRESHOLD=5
LOGIN_GUARD_KNOWN_FAILURE_THRESHOLD=3
LOGIN_GUARD_BASE_COOLDOWN_SECONDS=30
LOGIN_GUARD_MAX_COOLDOWN_SECONDS=900
LOGIN_GUARD_KNOWN_BASE_COOLDOWN_SECONDS=60
LOGIN_GUARD_KNOWN_MAX_COOLDOWN_SECONDS=1800
LOGIN_GUARD_RETENTION_SECONDS=3600
LOGIN_GUARD_MAX_KEYS=20000
LOGIN_GUARD_TRUST_PROXY_HEADERS=false
